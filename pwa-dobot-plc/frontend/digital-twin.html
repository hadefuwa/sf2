<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <link rel="apple-touch-icon" sizes="76x76" href="./assets/img/apple-icon.png">
  <link rel="icon" type="image/png" href="./assets/img/favicon.png">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>Digital Twin - Smart Factory</title>
  <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
  
  <!-- Fonts and icons -->
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
  
  <!-- CSS Files -->
  <link href="./assets/css/material-dashboard.min.css?v=2.1.0" rel="stylesheet" />
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#1c1b1f">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <style>
    /* Custom styles for 3D visualization */
    .card:hover {
      transform: translateY(-5px);
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    #canvas-container {
      position: relative;
      width: 100%;
      height: calc(100vh - 200px);
      min-height: 600px;
      border-radius: 6px;
      overflow: hidden;
      background: #0f0e11;
      border: 1px solid #44464f;
    }

    #dashboard {
      position: absolute;
      top: 20px;
      right: 20px;
      z-index: 10;
      background: rgba(36, 35, 42, 0.95);
      backdrop-filter: blur(20px);
      padding: 24px;
      border-radius: 12px;
      font-size: 13px;
      width: 320px;
      border: 1px solid #44464f;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
    }

    #dashboard h3 {
      margin: 0 0 20px 0;
      font-size: 18px;
      font-weight: 700;
      color: #a8c7fa;
      border-bottom: 1px solid #44464f;
      padding-bottom: 12px;
      letter-spacing: -0.5px;
    }

    .metric-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 10px 0;
      padding: 12px 14px;
      background: rgba(62, 61, 69, 0.5);
      border-radius: 8px;
      border: 1px solid #44464f;
      transition: all 0.3s ease;
    }

    .metric-row:hover {
      background: rgba(62, 61, 69, 0.8);
      border-color: #8f9099;
    }

    .metric-label {
      color: #c5c6d0;
      font-size: 12px;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .metric-value {
      color: #e4e1e6;
      font-weight: 700;
      font-size: 14px;
    }

    .metric-value.good {
      color: #4caf50;
    }

    .status-indicator {
      display: inline-block;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      margin-right: 0;
    }

    .status-indicator.running {
      background: #4caf50;
      animation: pulse 2s infinite;
      box-shadow: 0 0 12px #4caf50;
    }

    .status-indicator.idle {
      background: #f59e0b;
      box-shadow: 0 0 12px #f59e0b;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.6; transform: scale(1.2); }
    }

    .section {
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid #44464f;
    }

    .section > div:first-child {
      font-size: 11px;
      color: #8f9099;
      margin-bottom: 14px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .chart-mini {
      height: 40px;
      background: rgba(15, 14, 17, 0.5);
      border: 1px solid #44464f;
      border-radius: 8px;
      margin-top: 8px;
    }

    .control-buttons {
      position: absolute;
      bottom: 30px;
      left: 30px;
      z-index: 10;
      display: flex;
      gap: 12px;
    }

    .control-buttons button {
      background: linear-gradient(135deg, #9c27b0, #7b1fa2);
      color: white;
      border: none;
      padding: 14px 28px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 4px 16px rgba(156, 39, 176, 0.4);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .control-buttons button:hover {
      background: linear-gradient(135deg, #7b1fa2, #6a1b9a);
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(156, 39, 176, 0.5);
    }

    .control-buttons button:active {
      transform: translateY(0);
    }
  </style>
</head>

<body class="dark-edition">
  <div class="wrapper">
    <div class="sidebar" data-color="purple" data-background-color="black" data-image="./assets/img/sidebar-2.jpg">
      <div class="logo">
        <a href="/" class="simple-text logo-normal">
          <i class="material-icons">factory</i>
          Smart Factory
        </a>
      </div>
      <div class="sidebar-wrapper">
        <ul class="nav">
          <li class="nav-item">
            <a class="nav-link" href="/index.html">
              <i class="material-icons">dashboard</i>
              <p>Dashboard</p>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/robot-arm.html">
              <i class="material-icons">precision_manufacturing</i>
              <p>Robot Arm</p>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/vision-system.html">
              <i class="material-icons">visibility</i>
              <p>Vision System</p>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/smart-factory.html">
              <i class="material-icons">settings</i>
              <p>Factory Control</p>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/rfid.html">
              <i class="material-icons">nfc</i>
              <p>RFID Tracking</p>
            </a>
          </li>
          <li class="nav-item active">
            <a class="nav-link" href="/digital-twin.html">
              <i class="material-icons">view_in_ar</i>
              <p>Digital Twin</p>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/plc-diagnostics.html">
              <i class="material-icons">analytics</i>
              <p>PLC Diagnostics</p>
            </a>
          </li>
        </ul>
      </div>
    </div>

    <div class="main-panel">
      <!-- Navbar -->
      <nav class="navbar navbar-expand-lg navbar-transparent navbar-absolute fixed-top">
        <div class="container-fluid">
          <div class="navbar-wrapper">
            <a class="navbar-brand" href="javascript:;">Digital Twin</a>
          </div>
          <button class="navbar-toggler" type="button" data-toggle="collapse" aria-controls="navigation-index" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="navbar-toggler-icon icon-bar"></span>
            <span class="navbar-toggler-icon icon-bar"></span>
            <span class="navbar-toggler-icon icon-bar"></span>
          </button>
        </div>
      </nav>
      <!-- End Navbar -->

      <div class="content">
        <div class="container-fluid">
          <div class="row">
            <div class="col-md-12">
              <div class="card">
                <div class="card-header card-header-primary">
                  <h4 class="card-title">Factory Digital Twin - 3D Visualization</h4>
                  <p class="card-category">Real-time 3D simulation of factory operations</p>
                </div>
                <div class="card-body">
                  <!-- 3D Canvas Container -->
                  <div id="canvas-container">
                    <!-- Dashboard Overlay -->
                    <div id="dashboard">
                      <h3>Live Metrics</h3>

                      <div class="metric-row">
                        <span class="metric-label">Throughput</span>
                        <span class="metric-value" id="throughput">0 boxes/min</span>
                      </div>
                      <div class="metric-row">
                        <span class="metric-label">Boxes Processed</span>
                        <span class="metric-value" id="boxesProcessed">0</span>
                      </div>
                      <div class="metric-row">
                        <span class="metric-label">Avg Cycle Time</span>
                        <span class="metric-value" id="cycleTime">0.0s</span>
                      </div>

                      <div class="section">
                        <div>Equipment Status</div>
                        <div class="metric-row">
                          <span class="metric-label"><span class="status-indicator running" id="gantry-status"></span>Gantry</span>
                          <span class="metric-value" id="gantry-state">Idle</span>
                        </div>
                        <div class="metric-row">
                          <span class="metric-label"><span class="status-indicator running" id="conv1-status"></span>Conveyor 1</span>
                          <span class="metric-value" id="conv1-state">Running</span>
                        </div>
                        <div class="metric-row">
                          <span class="metric-label"><span class="status-indicator running" id="conv2-status"></span>Conveyor 2</span>
                          <span class="metric-value" id="conv2-state">Running</span>
                        </div>
                        <div class="metric-row">
                          <span class="metric-label"><span class="status-indicator idle" id="robot-status"></span>Robot</span>
                          <span class="metric-value" id="robot-state">Ready</span>
                        </div>
                      </div>

                      <div class="section">
                        <div>Queue Status</div>
                        <div class="metric-row">
                          <span class="metric-label">Waiting to Release</span>
                          <span class="metric-value" id="queueWaiting">0</span>
                        </div>
                        <div class="metric-row">
                          <span class="metric-label">In Transit</span>
                          <span class="metric-value" id="inTransit">0</span>
                        </div>
                        <div class="metric-row">
                          <span class="metric-label">On Pallet</span>
                          <span class="metric-value good" id="onPallet">0</span>
                        </div>
                      </div>

                      <div class="section">
                        <div>Production Rate (last 60s)</div>
                        <canvas id="throughputChart" class="chart-mini" width="250" height="40"></canvas>
                      </div>
                    </div>

                    <!-- Control Buttons -->
                    <div class="control-buttons">
                      <button id="reset">Reset Cycle</button>
                      <button id="release">Release 1 Box</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Core JS Files -->
  <script src="./assets/js/core/jquery.min.js"></script>
  <script src="./assets/js/core/popper.min.js"></script>
  <script src="./assets/js/core/bootstrap-material-design.min.js"></script>
  <script src="./assets/js/plugins/perfect-scrollbar.jquery.min.js"></script>
  <script src="./assets/js/material-dashboard.min.js?v=2.1.0" type="text/javascript"></script>

  <!-- Three.js Import Map and Main Script -->
  <script type="importmap">
  {
    "imports": {
      "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
      "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
    }
  }
  </script>
  <script type="module">
    import('./digital-twin-main.js').catch(err => {
      console.error('Module load failed:', err);
    });
  </script>
</body>
</html>
 --md-sys-color-primary: #a8c7fa;
 --md-sys-color-on-primary: #0b3d8c;
 --md-sys-color-primary-container: #1e54a4;
 --md-sys-color-on-primary-container: #d6e3ff;

 --md-sys-color-secondary: #bcc7dc;
 --md-sys-color-on-secondary: #263141;
 --md-sys-color-secondary-container: #3c4758;
 --md-sys-color-on-secondary-container: #d8e3f8;

 --md-sys-color-tertiary: #d7bce0;
 --md-sys-color-on-tertiary: #3b2948;
 --md-sys-color-tertiary-container: #533f5f;
 --md-sys-color-on-tertiary-container: #f3dafd;

 --md-sys-color-error: #ffb4ab;
 --md-sys-color-on-error: #690005;
 --md-sys-color-error-container: #93000a;
 --md-sys-color-on-error-container: #ffdad6;

 --md-sys-color-background: #1c1b1f;
 --md-sys-color-on-background: #e4e1e6;
 --md-sys-color-surface: #1c1b1f;
 --md-sys-color-on-surface: #e4e1e6;
 --md-sys-color-surface-variant: #44464f;
 --md-sys-color-on-surface-variant: #c5c6d0;

 --md-sys-color-outline: #8f9099;
 --md-sys-color-outline-variant: #44464f;

 --md-sys-color-surface-container-lowest: #0f0e11;
 --md-sys-color-surface-container-low: #24232a;
 --md-sys-color-surface-container: #282730;
 --md-sys-color-surface-container-high: #33323a;
 --md-sys-color-surface-container-highest: #3e3d45;

 /* Elevation Shadows */
 --md-sys-elevation-1: 0px 1px 2px rgba(0, 0, 0, 0.3), 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
 --md-sys-elevation-2: 0px 1px 2px rgba(0, 0, 0, 0.3), 0px 2px 6px 2px rgba(0, 0, 0, 0.15);
 --md-sys-elevation-3: 0px 4px 8px 3px rgba(0, 0, 0, 0.15), 0px 1px 3px rgba(0, 0, 0, 0.3);

 /* Shape */
 --md-sys-shape-corner-small: 8px;
 --md-sys-shape-corner-medium: 12px;
 --md-sys-shape-corner-large: 16px;

 /* Legacy compat colors */
 --status-success: #4caf50;
 --status-warning: #f59e0b;
 --status-error: #ef4444;

 /* Typography */
 --font-family: 'Roboto', -apple-system, BlinkMacSystemFont, sans-serif;
 }

 /* ========== RESET & BASE ========== */
 * {
 margin: 0;
 padding: 0;
 box-sizing: border-box;
 }

 body {
 font-family: var(--font-family);
 background: var(--md-sys-color-background);
 min-height: 100vh;
 color: var(--md-sys-color-on-background);
 display: flex;
 overflow: hidden;
 position: relative;
 line-height: 1.6;
 }

 /* ========== ANIMATED BACKGROUND ========== */
 .background-layer {
 position: fixed;
 inset: 0;
 z-index: -1;
 overflow: hidden;
 }

 /* Animated Grid Network */
 .grid-network {
 position: absolute;
 inset: 0;
 background-image:
 linear-gradient(rgba(14, 165, 233, 0.03) 1.5px, transparent 1.5px),
 linear-gradient(90deg, rgba(14, 165, 233, 0.03) 1.5px, transparent 1.5px);
 background-size: 80px 80px;
 animation: gridFlow 20s linear infinite;
 }

 @keyframes gridFlow {
 0% { transform: translate(0, 0); }
 100% { transform: translate(80px, 80px); }
 }

 /* Animated Connection Nodes */
 .connection-nodes {
 position: absolute;
 inset: 0;
 }

 .node {
 position: absolute;
 width: 8px;
 height: 8px;
 background: var(--md-sys-color-primary);
 border-radius: 50%;
 box-shadow: 0 0 20px var(--md-sys-color-primary), 0 0 40px var(--md-sys-color-primary);
 animation: nodePulse 3s ease-in-out infinite;
 }

 @keyframes nodePulse {
 0%, 100% {
 transform: scale(1);
 opacity: 1;
 }
 50% {
 transform: scale(1.5);
 opacity: 0.7;
 }
 }

 /* Data Flow Lines */
 .data-streams {
 position: absolute;
 inset: 0;
 }

 .stream-line {
 position: absolute;
 height: 2px;
 background: linear-gradient(90deg,
 transparent 0%,
 var(--md-sys-color-primary) 50%,
 transparent 100%
 );
 animation: streamFlow 4s linear infinite;
 opacity: 0.6;
 }

 @keyframes streamFlow {
 0% { transform: translateX(-100%); }
 100% { transform: translateX(200%); }
 }

 /* Subtle Gradient Orbs */
 .gradient-orb {
 position: absolute;
 border-radius: 50%;
 filter: blur(100px);
 opacity: 0.15;
 animation: orbFloat 25s ease-in-out infinite;
 }

 .gradient-orb.orb-1 {
 width: 500px;
 height: 500px;
 background: radial-gradient(circle, var(--md-sys-color-primary), transparent);
 top: -200px;
 left: -200px;
 }

 .gradient-orb.orb-2 {
 width: 600px;
 height: 600px;
 background: radial-gradient(circle, var(--md-sys-color-secondary), transparent);
 bottom: -250px;
 right: -250px;
 animation-delay: 8s;
 }

 .gradient-orb.orb-3 {
 width: 400px;
 height: 400px;
 background: radial-gradient(circle, var(--md-sys-color-tertiary), transparent);
 top: 40%;
 left: 60%;
 animation-delay: 16s;
 }

 @keyframes orbFloat {
 0%, 100% { transform: translate(0, 0) scale(1); }
 33% { transform: translate(80px, -60px) scale(1.1); }
 66% { transform: translate(-60px, 80px) scale(0.95); }
 }

 /* ========== SIDEBAR ========== */
 .sidebar {
 width: 280px;
 background: var(--md-sys-color-surface-container-low);
 backdrop-filter: blur(20px);
 border-right: 1px solid var(--md-sys-color-outline-variant);
 position: fixed;
 left: 0;
 top: 0;
 height: 100vh;
 z-index: 1000;
 display: flex;
 flex-direction: column;
 overflow-y: auto;
 }

 .sidebar-header {
 padding: 32px 24px;
 border-bottom: 1px solid var(--md-sys-color-outline-variant);
 }

 .logo-container {
 display: flex;
 align-items: center;
 gap: 12px;
 margin-bottom: 8px;
 }

 .logo-icon {
 width: 40px;
 height: 40px;
 background: linear-gradient(135deg, var(--md-sys-color-primary), var(--md-sys-color-secondary));
 border-radius: 8px;
 display: flex;
 align-items: center;
 justify-content: center;
 font-size: 18px;
 font-weight: 700;
 color: white;
 box-shadow: 0 4px 16px rgba(14, 165, 233, 0.3);
 }

 .logo-text h2 {
 font-size: 18px;
 font-weight: 700;
 color: var(--md-sys-color-on-surface);
 letter-spacing: -0.5px;
 }

 .logo-text p {
 font-size: 11px;
 color: var(--md-sys-color-outline);
 text-transform: uppercase;
 letter-spacing: 1.5px;
 font-weight: 600;
 }

 .status-indicator-header {
 display: flex;
 align-items: center;
 gap: 8px;
 padding: 12px 16px;
 background: var(--md-sys-color-surface-container-highest);
 border: 1px solid var(--md-sys-color-outline-variant);
 border-radius: 8px;
 margin-top: 16px;
 }

 .status-dot-header {
 width: 8px;
 height: 8px;
 background: var(--status-success);
 border-radius: 50%;
 animation: statusPulse 2s ease-in-out infinite;
 box-shadow: 0 0 12px var(--status-success);
 }

 @keyframes statusPulse {
 0%, 100% { opacity: 1; transform: scale(1); }
 50% { opacity: 0.6; transform: scale(1.2); }
 }

 .status-text-header {
 font-size: 12px;
 color: var(--md-sys-color-on-surface-variant);
 font-weight: 500;
 }

 .sidebar-nav {
 flex: 1;
 padding: 24px 16px;
 }

 .nav-section {
 margin-bottom: 32px;
 }

 .nav-section-title {
 font-size: 11px;
 font-weight: 700;
 text-transform: uppercase;
 letter-spacing: 1.5px;
 color: var(--md-sys-color-outline);
 margin-bottom: 12px;
 padding: 0 12px;
 }

 .nav-menu {
 list-style: none;
 }

 .nav-item {
 margin-bottom: 4px;
 }

 .nav-link {
 display: flex;
 align-items: center;
 gap: 12px;
 padding: 12px 16px;
 text-decoration: none;
 color: var(--md-sys-color-on-surface-variant);
 border-radius: 8px;
 transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
 font-size: 14px;
 font-weight: 500;
 position: relative;
 overflow: hidden;
 }

 .nav-link::before {
 content: '';
 position: absolute;
 left: 0;
 top: 0;
 height: 100%;
 width: 3px;
 background: var(--md-sys-color-primary);
 transform: scaleY(0);
 transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
 }

 .nav-link:hover {
 color: var(--md-sys-color-on-surface);
 background: var(--md-sys-color-surface-container-highest);
 }

 .nav-link.active {
 color: var(--md-sys-color-primary);
 background: rgba(14, 165, 233, 0.1);
 }

 .nav-link.active::before {
 transform: scaleY(1);
 }

 .nav-icon {
 width: 20px;
 height: 20px;
 display: flex;
 align-items: center;
 justify-content: center;
 font-size: 16px;
 }

 /* ========== 3D CANVAS CONTAINER ========== */
 #canvas-container {
 margin-left: 280px;
 width: calc(100% - 280px);
 height: 100vh;
 position: relative;
 }

 /* ========== DASHBOARD OVERLAY ========== */
 #dashboard {
 position: fixed;
 top: 10px;
 right: 10px;
 z-index: 10;
 background: var(--md-sys-color-surface-container-low);
 backdrop-filter: blur(20px);
 padding: 20px;
 border-radius: 16px;
 font-size: 12px;
 width: 300px;
 border: 1px solid var(--md-sys-color-outline-variant);
 box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
 }

 #dashboard h3 {
 margin: 0 0 16px 0;
 font-size: 16px;
 font-weight: 700;
 color: var(--md-sys-color-primary);
 border-bottom: 1px solid var(--md-sys-color-outline-variant);
 padding-bottom: 12px;
 letter-spacing: -0.5px;
 }

 .metric-row {
 display: flex;
 justify-content: space-between;
 align-items: center;
 margin: 8px 0;
 padding: 10px 12px;
 background: var(--md-sys-color-surface-container-highest);
 border-radius: 8px;
 border: 1px solid var(--md-sys-color-outline-variant);
 transition: all 0.3s ease;
 }

 .metric-row:hover {
 background: rgba(14, 165, 233, 0.05);
 border-color: var(--md-sys-color-outline);
 }

 .metric-label {
 color: var(--md-sys-color-on-surface-variant);
 font-size: 11px;
 font-weight: 500;
 display: flex;
 align-items: center;
 gap: 8px;
 }

 .metric-value {
 color: var(--md-sys-color-on-surface);
 font-weight: 700;
 font-size: 14px;
 }

 .metric-value.good {
 color: var(--status-success);
 }

 .metric-value.warning {
 color: var(--status-warning);
 }

 .metric-value.error {
 color: var(--status-error);
 }

 .status-indicator {
 display: inline-block;
 width: 8px;
 height: 8px;
 border-radius: 50%;
 margin-right: 0;
 }

 .status-indicator.running {
 background: var(--status-success);
 animation: pulse 2s infinite;
 box-shadow: 0 0 12px var(--status-success);
 }

 .status-indicator.idle {
 background: var(--status-warning);
 box-shadow: 0 0 12px var(--status-warning);
 }

 .status-indicator.stopped {
 background: var(--md-sys-color-outline);
 }

 @keyframes pulse {
 0%, 100% { opacity: 1; transform: scale(1); }
 50% { opacity: 0.6; transform: scale(1.2); }
 }

 .section {
 margin-top: 16px;
 padding-top: 16px;
 border-top: 1px solid var(--md-sys-color-outline-variant);
 }

 .section > div:first-child {
 font-size: 11px;
 color: var(--md-sys-color-outline);
 margin-bottom: 12px;
 font-weight: 600;
 text-transform: uppercase;
 letter-spacing: 1px;
 }

 .chart-mini {
 height: 40px;
 background: var(--md-sys-color-surface-container-highest);
 border: 1px solid var(--md-sys-color-outline-variant);
 border-radius: 8px;
 margin-top: 8px;
 position: relative;
 overflow: hidden;
 }

 /* ========== CONTROL BUTTONS ========== */
 #reset {
 position: fixed;
 bottom: 24px;
 left: 304px;
 z-index: 10;
 background: linear-gradient(135deg, var(--status-success), #059669);
 color: white;
 border: 1px solid var(--md-sys-color-outline-variant);
 padding: 14px 28px;
 border-radius: 10px;
 font-size: 14px;
 font-weight: 600;
 font-family: var(--font-family);
 cursor: pointer;
 box-shadow: 0 4px 16px rgba(16, 185, 129, 0.3);
 transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
 letter-spacing: 0.3px;
 }

 #reset:hover {
 background: linear-gradient(135deg, #059669, var(--status-success));
 transform: translateY(-2px);
 box-shadow: 0 8px 24px rgba(16, 185, 129, 0.4);
 border-color: var(--status-success);
 }

 #reset:active {
 transform: translateY(0);
 box-shadow: 0 4px 16px rgba(16, 185, 129, 0.3);
 }

 #release {
 position: fixed;
 bottom: 24px;
 left: 464px;
 z-index: 10;
 background: linear-gradient(135deg, var(--md-sys-color-primary), #0284c7);
 color: white;
 border: 1px solid var(--md-sys-color-outline-variant);
 padding: 14px 28px;
 border-radius: 10px;
 font-size: 14px;
 font-weight: 600;
 font-family: var(--font-family);
 cursor: pointer;
 box-shadow: 0 4px 16px rgba(14, 165, 233, 0.3);
 transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
 letter-spacing: 0.3px;
 }

 #release:hover {
 background: linear-gradient(135deg, #0284c7, var(--md-sys-color-primary));
 transform: translateY(-2px);
 box-shadow: 0 8px 24px rgba(14, 165, 233, 0.4);
 border-color: var(--md-sys-color-primary);
 }

 #release:active {
 transform: translateY(0);
 box-shadow: 0 4px 16px rgba(14, 165, 233, 0.3);
 }

 /* ========== SCROLLBAR ========== */
 ::-webkit-scrollbar {
 width: 8px;
 height: 8px;
 }

 ::-webkit-scrollbar-track {
 background: var(--md-sys-color-background);
 }

 ::-webkit-scrollbar-thumb {
 background: var(--md-sys-color-outline);
 border-radius: 4px;
 }

 ::-webkit-scrollbar-thumb:hover {
 background: var(--md-sys-color-primary);
 }

 /* ========== RESPONSIVE ========== */
 @media (max-width: 1024px) {
 .sidebar {
 width: 80px;
 }

 .logo-text,
 .status-indicator-header,
 .nav-section-title,
 .nav-link span:not(.nav-icon) {
 display: none;
 }

 .sidebar-header {
 padding: 24px 16px;
 }

 .logo-icon {
 margin: 0 auto;
 }

 .nav-link {
 justify-content: center;
 padding: 12px;
 }

 #canvas-container {
 margin-left: 80px;
 width: calc(100% - 80px);
 }

 #dashboard {
 width: 260px;
 }

 #reset {
 left: 104px;
 padding: 12px 20px;
 }

 #release {
 left: 244px;
 padding: 12px 20px;
 }
 }

 @media (max-width: 768px) {
 .sidebar {
 transform: translateX(-100%);
 transition: transform 0.3s ease;
 }

 .sidebar.mobile-open {
 transform: translateX(0);
 }

 #canvas-container {
 margin-left: 0;
 width: 100%;
 }

 #dashboard {
 top: 10px;
 right: 10px;
 width: 240px;
 padding: 16px;
 }

 #reset {
 left: 20px;
 bottom: 20px;
 }

 #release {
 left: 150px;
 bottom: 20px;
 }
 }

 /* Reduced Motion */
 @media (prefers-reduced-motion: reduce) {
 * {
 animation-duration: 0.01ms !important;
 animation-iteration-count: 1 !important;
 transition-duration: 0.01ms !important;
 }
 }
 </style>
</head>
<body>
 <!-- Animated Background -->
 <div class="background-layer">
 <div class="grid-network"></div>
 <div class="gradient-orb orb-1"></div>
 <div class="gradient-orb orb-2"></div>
 <div class="gradient-orb orb-3"></div>
 <div class="connection-nodes" id="connectionNodes"></div>
 <div class="data-streams" id="dataStreams"></div>
 </div>

 <!-- Sidebar Navigation -->
 <nav class="sidebar">
 <div class="sidebar-header">
 <div class="logo-container">
 <div class="logo-icon">SF</div>
 <div class="logo-text">
 <h2>Smart Factory</h2>
 <p>IIoT Platform</p>
 </div>
 </div>
 <div class="status-indicator-header">
 <div class="status-dot-header"></div>
 <span class="status-text-header">System Online</span>
 </div>
 </div>

 <div class="sidebar-nav">
 <nav class="nav-section">
 <h3 class="nav-section-title">Navigation</h3>
 <ul class="nav-menu">
 <li class="nav-item">
 <a href="/" class="nav-link">
 <span class="nav-icon">ðŸ </span>
 <span>Dashboard</span>
 </a>
 </li>
 <li class="nav-item">
 <a href="/robot-arm.html" class="nav-link">
 <span class="nav-icon">ðŸ¤–</span>
 <span>Robot Arm</span>
 </a>
 </li>
 <li class="nav-item">
 <a href="/smart-factory.html" class="nav-link">
 <span class="nav-icon">ðŸ­</span>
 <span>Smart Factory</span>
 </a>
 </li>
 <li class="nav-item">
 <a href="/vision-system.html" class="nav-link">
 <span class="nav-icon">ðŸ‘</span>
 <span>Vision System</span>
 </a>
 </li>
 <li class="nav-item">
 <a href="/rfid.html" class="nav-link">
 <span class="nav-icon">ðŸ“¡</span>
 <span>RFID</span>
 </a>
 </li>
 <li class="nav-item">
 <a href="/digital-twin.html" class="nav-link active">
 <span class="nav-icon">ðŸ”„</span>
 <span>Digital Twin</span>
 </a>
 </li>
 <li class="nav-item">
 <a href="/plc-diagnostics.html" class="nav-link">
 <span class="nav-icon">âš™ï¸</span>
 <span>PLC Diagnostics</span>
 </a>
 </li>
 </ul>
 </nav>
 </div>
 </nav>

 <!-- 3D Canvas Container -->
 <div id="canvas-container"></div>

 <!-- Control Buttons -->
 <button id="reset">Reset Cycle</button>
 <button id="release">Release 1 Box</button>

 <!-- Dashboard -->
 <div id="dashboard">
 <h3>Live Metrics</h3>

 <div class="metric-row">
 <span class="metric-label">Throughput</span>
 <span class="metric-value" id="throughput">0 boxes/min</span>
 </div>
 <div class="metric-row">
 <span class="metric-label">Boxes Processed</span>
 <span class="metric-value" id="boxesProcessed">0</span>
 </div>
 <div class="metric-row">
 <span class="metric-label">Avg Cycle Time</span>
 <span class="metric-value" id="cycleTime">0.0s</span>
 </div>

 <div class="section">
 <div>Equipment Status</div>
 <div class="metric-row">
 <span class="metric-label"><span class="status-indicator running" id="gantry-status"></span>Gantry</span>
 <span class="metric-value" id="gantry-state">Idle</span>
 </div>
 <div class="metric-row">
 <span class="metric-label"><span class="status-indicator running" id="conv1-status"></span>Conveyor 1</span>
 <span class="metric-value" id="conv1-state">Running</span>
 </div>
 <div class="metric-row">
 <span class="metric-label"><span class="status-indicator running" id="conv2-status"></span>Conveyor 2</span>
 <span class="metric-value" id="conv2-state">Running</span>
 </div>
 <div class="metric-row">
 <span class="metric-label"><span class="status-indicator idle" id="robot-status"></span>Robot</span>
 <span class="metric-value" id="robot-state">Ready</span>
 </div>
 </div>

 <div class="section">
 <div>Queue Status</div>
 <div class="metric-row">
 <span class="metric-label">Waiting to Release</span>
 <span class="metric-value" id="queueWaiting">0</span>
 </div>
 <div class="metric-row">
 <span class="metric-label">In Transit</span>
 <span class="metric-value" id="inTransit">0</span>
 </div>
 <div class="metric-row">
 <span class="metric-label">On Pallet</span>
 <span class="metric-value good" id="onPallet">0</span>
 </div>
 </div>

 <div class="section">
 <div>Production Rate (last 60s)</div>
 <canvas id="throughputChart" class="chart-mini" width="250" height="40"></canvas>
 </div>
 </div>

 <!-- Three.js Import Map and Main Script -->
 <script type="importmap">
 {
 "imports": {
 "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
 "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
 }
 }
 </script>
 <script type="module">
 import('./digital-twin-main.js').catch(err => {
 console.error('Module load failed:', err);
 });
 </script>

 <script>
 // Generate animated connection nodes
 function generateNodes() {
 const container = document.getElementById('connectionNodes');
 if (!container) return;

 const nodeCount = 15;
 for (let i = 0; i < nodeCount; i++) {
 const node = document.createElement('div');
 node.className = 'node';
 node.style.left = `${Math.random() * 100}%`;
 node.style.top = `${Math.random() * 100}%`;
 node.style.animationDelay = `${Math.random() * 3}s`;
 container.appendChild(node);
 }
 }

 // Generate data stream lines
 function generateDataStreams() {
 const container = document.getElementById('dataStreams');
 if (!container) return;

 const streamCount = 8;
 for (let i = 0; i < streamCount; i++) {
 const stream = document.createElement('div');
 stream.className = 'stream-line';
 stream.style.top = `${(100 / streamCount) * i + Math.random() * 10}%`;
 stream.style.width = `${200 + Math.random() * 300}px`;
 stream.style.animationDelay = `${Math.random() * 4}s`;
 stream.style.animationDuration = `${3 + Math.random() * 3}s`;
 container.appendChild(stream);
 }
 }

 // Initialize background animations
 generateNodes();
 generateDataStreams();

 // Regenerate on resize (debounced)
 let resizeTimer;
 window.addEventListener('resize', () => {
 clearTimeout(resizeTimer);
 resizeTimer = setTimeout(() => {
 const nodes = document.getElementById('connectionNodes');
 const streams = document.getElementById('dataStreams');
 if (nodes) nodes.innerHTML = '';
 if (streams) streams.innerHTML = '';
 generateNodes();
 generateDataStreams();
 }, 250);
 });
 </script>
</body>
</html>
