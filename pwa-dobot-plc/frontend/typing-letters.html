<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <link rel="apple-touch-icon" sizes="76x76" href="./assets/img/apple-icon.png">
  <link rel="icon" type="image/png" href="./assets/img/favicon.png">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>Typing Letters - Smart Factory</title>
  <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />

  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
  <link href="./assets/css/material-dashboard.min.css?v=2.1.0" rel="stylesheet" />
  <link href="./assets/css/professional-theme.css" rel="stylesheet" />

  <style>
    .typing-card {
      min-height: 460px;
    }
    .level-button {
      width: 100%;
      margin-bottom: 10px;
      text-transform: none;
    }
    .level-button.active {
      box-shadow: 0 8px 24px rgba(156, 39, 176, 0.35);
    }
    .target-letter {
      font-size: clamp(68px, 14vw, 140px);
      font-weight: 700;
      line-height: 1;
      margin: 24px 0;
      text-align: center;
      color: #ffffff;
      text-shadow: 0 0 20px rgba(156, 39, 176, 0.45);
    }
    .typing-input {
      text-align: center;
      font-size: 36px;
      font-weight: 700;
      letter-spacing: 4px;
      text-transform: uppercase;
      max-width: 140px;
      margin: 0 auto;
      color: #ffffff !important;
      caret-color: #ffffff;
    }
    .typing-input:focus {
      border-color: #9c27b0;
      box-shadow: 0 0 0 3px rgba(156, 39, 176, 0.2);
    }
    .game-feedback {
      min-height: 32px;
      margin-top: 12px;
      text-align: center;
      font-weight: 600;
    }
    .stats-row {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
      margin-top: 20px;
    }
    .stat-box {
      padding: 12px;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.04);
      text-align: center;
    }
    .stat-box .label {
      display: block;
      font-size: 12px;
      opacity: 0.75;
      margin-bottom: 4px;
    }
    .stat-box .value {
      display: block;
      font-size: 24px;
      font-weight: 700;
    }
    .keyboard-hint {
      text-align: center;
      font-size: 13px;
      opacity: 0.7;
      margin-top: 10px;
    }
    .lesson-select-label {
      display: block;
      margin-bottom: 8px;
      font-size: 13px;
      opacity: 0.85;
    }
    .game-prompt {
      text-align: center;
      font-size: 18px;
      font-weight: 600;
      margin-top: 6px;
      opacity: 0.95;
    }
    @media (max-width: 991px) {
      .typing-card {
        min-height: auto;
      }
    }
  </style>
</head>

<body class="dark-edition">
  <div class="wrapper">
    <div class="sidebar" data-color="purple" data-background-color="black" data-image="">
      <div class="sidebar-animated-bg" id="sidebarAnimatedBg"></div>
      <div class="logo">
        <a href="/" class="simple-text logo-normal">
          <i class="material-icons">factory</i>
          Smart Factory
        </a>
      </div>
      <div class="sidebar-wrapper">
        <ul class="nav">
          <li class="nav-item">
            <a class="nav-link" href="/index.html">
              <i class="material-icons">dashboard</i>
              <p>Dashboard</p>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/robot-arm.html">
              <i class="material-icons">precision_manufacturing</i>
              <p>Robot Arm</p>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/vision-system.html">
              <i class="material-icons">visibility</i>
              <p>Vision System</p>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/rfid.html">
              <i class="material-icons">nfc</i>
              <p>RFID Tracking</p>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/digital-twin.html">
              <i class="material-icons">view_in_ar</i>
              <p>Digital Twin</p>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/plc-diagnostics.html">
              <i class="material-icons">analytics</i>
              <p>PLC Diagnostics</p>
            </a>
          </li>
          <li class="nav-item active">
            <a class="nav-link" href="/typing-letters.html">
              <i class="material-icons">spellcheck</i>
              <p>Typing Letters</p>
            </a>
          </li>
        </ul>
      </div>
    </div>

    <div class="main-panel">
      <nav class="navbar navbar-expand-lg navbar-transparent navbar-absolute fixed-top">
        <div class="container-fluid">
          <div class="navbar-wrapper">
            <a class="navbar-brand" href="javascript:;">Typing Letters Game</a>
          </div>
        </div>
      </nav>

      <div class="content">
        <div class="container-fluid">
          <div class="row">
            <div class="col-lg-4 col-md-12">
              <div class="card">
                <div class="card-header card-header-purple">
                  <h4 class="card-title">Levels A-Z</h4>
                  <p class="card-category">Choose a letter set</p>
                </div>
                <div class="card-body">
                  <div id="levelButtons"></div>
                  <hr />
                  <label class="lesson-select-label" for="lessonTypeSelect">Lesson type</label>
                  <select id="lessonTypeSelect" class="form-control mb-3"></select>
                  <p class="mb-0">Each level has 10 questions. Change lesson type for more variety.</p>
                </div>
              </div>
            </div>

            <div class="col-lg-8 col-md-12">
              <div class="card typing-card">
                <div class="card-header card-header-info">
                  <h4 class="card-title" id="levelTitle">Level 1: A-E</h4>
                  <p class="card-category" id="lessonCategory">Look at the letter and type it</p>
                </div>
                <div class="card-body">
                  <div class="game-prompt" id="gamePrompt">Type this letter</div>
                  <div class="target-letter" id="targetLetter">A</div>

                  <div class="text-center">
                    <input
                      id="typingInput"
                      class="form-control typing-input"
                      type="text"
                      maxlength="1"
                      autocomplete="off"
                      placeholder="?"
                      aria-label="Type letter"
                    />
                    <button id="submitBtn" class="btn btn-primary mt-3">
                      <i class="material-icons">keyboard</i> Check Letter
                    </button>
                    <button id="nextLevelBtn" class="btn btn-success mt-3 ml-2" style="display: none;">
                      <i class="material-icons">arrow_forward</i> Next Level
                    </button>
                  </div>

                  <div class="keyboard-hint">Tip: Type letters and press Enter.</div>
                  <div class="game-feedback" id="gameFeedback"></div>

                  <div class="stats-row">
                    <div class="stat-box">
                      <span class="label">Correct</span>
                      <span class="value" id="correctCount">0</span>
                    </div>
                    <div class="stat-box">
                      <span class="label">Round</span>
                      <span class="value"><span id="roundStep">1</span>/10</span>
                    </div>
                    <div class="stat-box">
                      <span class="label">Accuracy</span>
                      <span class="value" id="accuracyValue">0%</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="./assets/js/core/jquery.min.js"></script>
  <script src="./assets/js/core/popper.min.js"></script>
  <script src="./assets/js/core/bootstrap-material-design.min.js"></script>
  <script src="./assets/js/plugins/perfect-scrollbar.jquery.min.js"></script>
  <script src="./assets/js/material-dashboard.js?v=2.1.0"></script>
  <script>
    const LEVELS = [
      { name: "Level 1", range: "A-E", letters: ["A", "B", "C", "D", "E"] },
      { name: "Level 2", range: "F-J", letters: ["F", "G", "H", "I", "J"] },
      { name: "Level 3", range: "K-O", letters: ["K", "L", "M", "N", "O"] },
      { name: "Level 4", range: "P-T", letters: ["P", "Q", "R", "S", "T"] },
      { name: "Level 5", range: "U-Z", letters: ["U", "V", "W", "X", "Y", "Z"] }
    ];
    const LESSON_TYPES = [
      { id: "copy", label: "Copy Letter", category: "Look at the letter and type it" },
      { id: "next", label: "Next Letter", category: "Type the letter that comes next" },
      { id: "before", label: "Letter Before", category: "Type the letter that comes before" },
      { id: "missing", label: "Missing Letter", category: "Fill in the missing middle letter" },
      { id: "mixed", label: "Mixed Challenge", category: "Mixed activities for extra variety" }
    ];
    const QUESTIONS_PER_LEVEL = 10;

    let currentLevelIndex = 0;
    let currentLessonTypeId = "copy";
    let currentQuestion = { prompt: "Type this letter", display: "A", answer: "A" };
    let attempts = 0;
    let correct = 0;
    let roundComplete = false;

    const levelButtons = document.getElementById("levelButtons");
    const levelTitle = document.getElementById("levelTitle");
    const lessonCategory = document.getElementById("lessonCategory");
    const lessonTypeSelect = document.getElementById("lessonTypeSelect");
    const gamePrompt = document.getElementById("gamePrompt");
    const targetLetter = document.getElementById("targetLetter");
    const typingInput = document.getElementById("typingInput");
    const submitBtn = document.getElementById("submitBtn");
    const nextLevelBtn = document.getElementById("nextLevelBtn");
    const gameFeedback = document.getElementById("gameFeedback");
    const correctCount = document.getElementById("correctCount");
    const roundStep = document.getElementById("roundStep");
    const accuracyValue = document.getElementById("accuracyValue");

    function randomIndex(max) {
      return Math.floor(Math.random() * max);
    }

    function randomLetterFrom(level) {
      return level.letters[randomIndex(level.letters.length)];
    }

    function getActiveLessonType() {
      return LESSON_TYPES.find((type) => type.id === currentLessonTypeId) || LESSON_TYPES[0];
    }

    function renderLessonTypes() {
      lessonTypeSelect.innerHTML = LESSON_TYPES.map((type) =>
        `<option value="${type.id}">${type.label}</option>`
      ).join("");
      lessonTypeSelect.value = currentLessonTypeId;
    }

    function renderLevelButtons() {
      levelButtons.innerHTML = LEVELS.map((level, index) => {
        const activeClass = index === currentLevelIndex ? "active btn-primary" : "btn-default";
        return `
          <button class="btn level-button ${activeClass}" data-level-index="${index}">
            ${level.name} (${level.range})
          </button>
        `;
      }).join("");

      levelButtons.querySelectorAll("[data-level-index]").forEach((button) => {
        button.addEventListener("click", () => startLevel(Number(button.dataset.levelIndex)));
      });
    }

    function updateStats() {
      correctCount.textContent = String(correct);
      roundStep.textContent = String(Math.min(attempts + 1, QUESTIONS_PER_LEVEL));
      const accuracy = attempts > 0 ? Math.round((correct / attempts) * 100) : 0;
      accuracyValue.textContent = `${accuracy}%`;
    }

    function buildCopyQuestion(level) {
      const letter = randomLetterFrom(level);
      return { prompt: "Type this letter", display: letter, answer: letter };
    }

    function buildNextQuestion(level) {
      const letters = level.letters;
      const index = randomIndex(letters.length - 1);
      return {
        prompt: `What comes after ${letters[index]}?`,
        display: `${letters[index]} ?`,
        answer: letters[index + 1]
      };
    }

    function buildBeforeQuestion(level) {
      const letters = level.letters;
      const index = 1 + randomIndex(letters.length - 1);
      return {
        prompt: `What comes before ${letters[index]}?`,
        display: `? ${letters[index]}`,
        answer: letters[index - 1]
      };
    }

    function buildMissingQuestion(level) {
      const letters = level.letters;
      const index = 1 + randomIndex(letters.length - 2);
      return {
        prompt: "Type the missing middle letter",
        display: `${letters[index - 1]} ? ${letters[index + 1]}`,
        answer: letters[index]
      };
    }

    function buildQuestion() {
      const level = LEVELS[currentLevelIndex];
      const lessonTypeId = currentLessonTypeId === "mixed"
        ? ["copy", "next", "before", "missing"][randomIndex(4)]
        : currentLessonTypeId;

      if (lessonTypeId === "next") return buildNextQuestion(level);
      if (lessonTypeId === "before") return buildBeforeQuestion(level);
      if (lessonTypeId === "missing") return buildMissingQuestion(level);
      return buildCopyQuestion(level);
    }

    function setNextQuestion() {
      currentQuestion = buildQuestion();
      gamePrompt.textContent = currentQuestion.prompt;
      targetLetter.textContent = currentQuestion.display;
      typingInput.value = "";
      typingInput.focus();
    }

    function finishRound() {
      roundComplete = true;
      const accuracy = Math.round((correct / QUESTIONS_PER_LEVEL) * 100);
      const message = accuracy >= 80 ? "Great job!" : "Nice effort! Try again to improve.";
      gameFeedback.className = "game-feedback text-info";
      gameFeedback.textContent = `${message} Score: ${correct}/${QUESTIONS_PER_LEVEL} (${accuracy}%)`;
      submitBtn.disabled = true;

      if (currentLevelIndex < LEVELS.length - 1) {
        nextLevelBtn.style.display = "inline-flex";
      }
    }

    function checkAnswer(inputChar) {
      if (roundComplete || !inputChar) return;

      const typed = inputChar.toUpperCase();
      if (!/^[A-Z]$/.test(typed)) return;

      attempts += 1;
      const isCorrect = typed === currentQuestion.answer;
      if (isCorrect) {
        correct += 1;
        gameFeedback.className = "game-feedback text-success";
        gameFeedback.textContent = "Correct!";
      } else {
        gameFeedback.className = "game-feedback text-warning";
        gameFeedback.textContent = `Try again. The right letter was ${currentQuestion.answer}.`;
      }

      updateStats();

      if (attempts >= QUESTIONS_PER_LEVEL) {
        finishRound();
      } else {
        setNextQuestion();
      }
    }

    function startLevel(levelIndex) {
      currentLevelIndex = levelIndex;
      attempts = 0;
      correct = 0;
      roundComplete = false;
      submitBtn.disabled = false;
      nextLevelBtn.style.display = "none";
      gameFeedback.className = "game-feedback";
      gameFeedback.textContent = "";
      levelTitle.textContent = `${LEVELS[currentLevelIndex].name}: ${LEVELS[currentLevelIndex].range}`;
      lessonCategory.textContent = getActiveLessonType().category;
      renderLevelButtons();
      updateStats();
      setNextQuestion();
    }

    submitBtn.addEventListener("click", () => checkAnswer(typingInput.value));
    lessonTypeSelect.addEventListener("change", () => {
      currentLessonTypeId = lessonTypeSelect.value;
      startLevel(currentLevelIndex);
    });
    typingInput.addEventListener("input", () => {
      typingInput.value = typingInput.value.toUpperCase().replace(/[^A-Z]/g, "").slice(0, 1);
    });
    typingInput.addEventListener("keydown", (event) => {
      if (event.key === "Enter") {
        event.preventDefault();
        checkAnswer(typingInput.value);
      } else if (/^[a-zA-Z]$/.test(event.key)) {
        event.preventDefault();
        checkAnswer(event.key);
      }
    });
    nextLevelBtn.addEventListener("click", () => {
      const nextIndex = Math.min(currentLevelIndex + 1, LEVELS.length - 1);
      startLevel(nextIndex);
    });

    renderLessonTypes();
    startLevel(0);
  </script>
</body>
</html>
